(this["webpackJsonpreact-web"]=this["webpackJsonpreact-web"]||[]).push([[0],{69:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(24),a=n.n(c),s=(n(69),n(8)),o=n(10),i=n.n(o),u=n(50),j=n(55),l=n(16),d=n(32),b={UserPoolId:"eu-west-2_NLsiUZHjm",AppClientId:"mdv4ljbutcvrncd6o3hfa0b8d",ApiURL:"https://5vkktm9ibl.execute-api.eu-west-2.amazonaws.com/Prod/notes"},h={UserPoolId:b.UserPoolId,ClientId:b.AppClientId},O=new d.c(h),x=n(2),f=Object(r.createContext)(),p=function(e){var t=Object(r.useState)(!1),n=Object(s.a)(t,2),c=n[0],a=n[1];Object(r.useEffect)((function(){o().then((function(e){a(!0)}),(function(){a(!1)}))}),[]);var o=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var n=O.getCurrentUser();n?n.getSession(function(){var r=Object(l.a)(i.a.mark((function r(c,a){var s,o;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!c){r.next=4;break}t(),r.next=9;break;case 4:return r.next=6,new Promise((function(e,t){n.getUserAttributes((function(n,r){if(n)t(n);else{var c,a={},s=Object(j.a)(r);try{for(s.s();!(c=s.n()).done;){var o=c.value,i=o.Name,u=o.Value;a[i]=u}}catch(n){s.e(n)}finally{s.f()}e(a)}}))}));case 6:s=r.sent,o=a.getIdToken().getJwtToken(),e(Object(u.a)(Object(u.a)({user:n,headers:{Authorization:o,"Content-Type":"application/json"}},a),s));case 9:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()):t()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var t=Object(l.a)(i.a.mark((function t(n,r){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,c){var s=new d.b({Username:n,Pool:O}),o=new d.a({Username:n,Password:r});s.authenticateUser(o,{onSuccess:function(e){console.log("onSuccess:",e),t(e),a(!0)},onFailure:function(t){e.setError(t),c(t)},newPasswordRequired:function(n){e.setError("New Password Required"),t(n)}})}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return Object(x.jsx)(f.Provider,{value:{authenticate:b,getSession:o,logout:function(){var e=O.getCurrentUser();e&&e.signOut(),a(!1)},LoggedIn:c},children:e.children})},v=n(30),m=n(11),g=n(85),w=n(86),N=n(57),y=n(87),I=function(){var e=Object(m.g)(),t=Object(r.useContext)(f),n=t.LoggedIn,c=t.logout;return Object(x.jsx)("header",{children:Object(x.jsx)(g.a,{children:Object(x.jsxs)(w.a,{children:[Object(x.jsx)(N.a,{sm:"11",children:Object(x.jsx)("h1",{children:"Polly Notes Application"})}),Object(x.jsx)(N.a,{sm:"1",children:n?Object(x.jsx)(g.a,{children:Object(x.jsx)(y.a,{size:"sm",onClick:function(){c(),e.push("/Login")},children:"Logout"})}):""})]})})})},S=n(93),k=function(e){return Object(x.jsx)(S.a,{variant:"danger",children:e.error.message})},C=n(91),P=n(88),T=function(){return Object(x.jsx)(P.a,{className:"spinner",animation:"border",role:"status",children:Object(x.jsx)("span",{className:"sr-only",children:"Loading..."})})},E=function(e){var t=function(){e.setShow(!1)};return Object(x.jsxs)(C.a,{show:e.show,onHide:t,children:[Object(x.jsx)(C.a.Header,{closeButton:!0,children:Object(x.jsx)(C.a.Title,{children:"Listen To The Note"})}),Object(x.jsx)(C.a.Body,{children:e.url?Object(x.jsxs)("audio",{controls:!0,src:e.url,children:["Your browser does not support the",Object(x.jsx)("code",{children:"audio"})," element."]}):Object(x.jsx)(T,{})}),Object(x.jsx)(C.a.Footer,{children:Object(x.jsx)(y.a,{variant:"primary",onClick:t,children:"Close"})})]})},L=n(89),U=n(60),A=n(90),F=n(92),R=n(49),z=n(59),J=function(e){var t=Object(r.useState)(""),n=Object(s.a)(t,2),c=n[0],a=n[1],o=Object(r.useState)(""),u=Object(s.a)(o,2),j=u[0],d=u[1],b=Object(r.useState)(!0),h=Object(s.a)(b,2),O=h[0],f=h[1],p=Object(r.useState)("american"),v=Object(s.a)(p,2),m=v[0],I=v[1],S=Object(r.useState)(""),k=Object(s.a)(S,2),C=k[0],P=k[1],E={american:{display:"American",voice:[{name:"Joey"},{name:"Joanna"}]},australian:{display:"Australian",voice:[{name:"Russell"},{name:"Nicole"}]},british:{display:"British",voice:[{name:"Brian"},{name:"Amy"}]},indian:{display:"Indian",voice:[{name:"Raveena"}]},welsh:{display:"Welsh",voice:[{name:"Geraint"}]}};Object(r.useEffect)(Object(l.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:O||e.noteFunctions.filterNotes(j);case 1:case"end":return t.stop()}}),t)}))),[j]),Object(r.useEffect)((function(){var e=setTimeout((function(){O?f(!1):d(c)}),250);return function(){clearTimeout(e)}}),[c]),Object(r.useEffect)((function(){P(E[m].voice[0].name)}),[m]),Object(r.useEffect)((function(){console.log(C)}),[C]);var J=e.notes.map((function(t){return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:Object(x.jsx)(y.a,{active:e.selNote.NoteId===t.NoteId,variant:"outline-info",onClick:function(){return n=t.NoteId,void e.noteFunctions.handleSelectNote(n);var n},children:Object(x.jsx)(z.a,{})})}),Object(x.jsx)("td",{children:t.NoteId}),Object(x.jsx)("td",{width:"70%",children:t.Note}),Object(x.jsxs)("td",{width:"20%",align:"right",children:[Object(x.jsx)(y.a,{onClick:function(){return n=t.NoteId,void e.noteFunctions.speakNote(n,C);var n},variant:"outline-info",children:Object(x.jsx)(R.b,{})}),Object(x.jsx)(y.a,{onClick:function(){return n=t.NoteId,void e.noteFunctions.deleteNote(n);var n},variant:"outline-info",children:e.deleting==t.NoteId?Object(x.jsx)(T,{}):Object(x.jsx)(R.a,{})})]})]},t.NoteId)})),G=Object.entries(E).map((function(e){return Object(x.jsx)("option",{value:e[0],children:e[1].display},e[0])})),B=E[m].voice.map((function(e,t){return Object(x.jsx)("option",{value:e.name,children:e.name},t)}));return Object(x.jsxs)(g.a,{children:[Object(x.jsxs)(L.a,{className:"mb-3",children:[Object(x.jsx)(L.a.Prepend,{children:Object(x.jsx)(L.a.Text,{id:"search-heading",children:"Search Notes:"})}),Object(x.jsx)(U.a,{placeholder:"Search for","aria-label":"SearchBox","aria-describedby":"search-heading",value:c,onChange:function(e){return a(e.target.value)}}),Object(x.jsx)(L.a.Append,{children:Object(x.jsx)(L.a.Text,{id:"search-heading",children:e.searching?Object(x.jsx)(T,{}):null})})]}),Object(x.jsxs)(A.a,{striped:!0,borderless:!0,hover:!0,size:"sm",children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{}),Object(x.jsx)("th",{children:"ID"}),Object(x.jsx)("th",{children:"Note"}),Object(x.jsx)("th",{})]})}),Object(x.jsx)("tbody",{children:J}),Object(x.jsx)("tfoot",{children:Object(x.jsx)("tr",{children:Object(x.jsx)("td",{colSpan:"4",children:Object(x.jsxs)(w.a,{children:[Object(x.jsx)(N.a,{lg:"7"}),Object(x.jsx)(N.a,{lg:"5",children:Object(x.jsx)(F.a,{inline:!0,children:Object(x.jsxs)(F.a.Group,{children:[Object(x.jsx)(F.a.Label,{srOnly:!0,children:"Voice Accent"}),Object(x.jsxs)(L.a,{size:"sm",children:[Object(x.jsx)(L.a.Prepend,{size:"sm",children:Object(x.jsx)(L.a.Text,{children:"Polly Accent and Voice:"})}),Object(x.jsx)(F.a.Control,{as:"select",size:"sm",value:m,onChange:function(e){return I(e.target.value)},children:G}),Object(x.jsx)(F.a.Control,{as:"select",size:"sm",value:C,onChange:function(e){return P(e.target.value)},children:B})]})]})})})]})})})})]})]})},G=function(e){var t=Object(r.useState)(""),n=Object(s.a)(t,2),c=n[0],a=n[1];Object(r.useEffect)((function(){e.selNote.Note?a(e.selNote.Note):a("")}),[e.selNote]);return Object(x.jsx)(g.a,{children:Object(x.jsx)(F.a,{onSubmit:function(t){return function(t){t.preventDefault(),""!=c&&(""!=e.selNote.NoteId?(e.noteFunctions.updateNote(e.selNote,c),a("")):(e.noteFunctions.addNote(c),a("")))}(t)},children:Object(x.jsxs)(w.a,{children:[Object(x.jsx)(N.a,{sm:"11",children:Object(x.jsxs)(F.a.Group,{controlId:"noteEditor",children:[Object(x.jsx)(F.a.Label,{column:!0,sm:"1",srOnly:!0,children:"Note"}),Object(x.jsxs)(L.a,{children:[Object(x.jsx)(L.a.Prepend,{children:Object(x.jsx)(L.a.Text,{children:"Note:"})}),Object(x.jsx)(F.a.Control,{value:c,onChange:function(e){return a(e.target.value)},placeholder:"Note Text...."})]})]})}),Object(x.jsx)(N.a,{sm:"1",align:"left",children:Object(x.jsx)(y.a,{variant:"outline-primary",type:"submit",children:e.updating?Object(x.jsx)(T,{}):""==e.selNote.NoteId?"Add":"Update"})})]})})})};var B=function(e){var t=Object(r.useState)([]),n=Object(s.a)(t,2),c=n[0],a=n[1],o=Object(r.useState)({NoteId:""}),u=Object(s.a)(o,2),j=u[0],d=u[1],h=Object(r.useState)(!1),O=Object(s.a)(h,2),p=O[0],v=O[1],g=Object(r.useState)(!1),w=Object(s.a)(g,2),N=w[0],y=w[1],I=Object(r.useState)(null),S=Object(s.a)(I,2),k=S[0],C=S[1],P=Object(r.useState)(!1),L=Object(s.a)(P,2),U=L[0],A=L[1],F=Object(r.useState)({}),R=Object(s.a)(F,2),z=R[0],B=R[1],D=Object(r.useState)(!1),q=Object(s.a)(D,2),V=q[0],H=q[1],_=Object(r.useState)(!1),W=Object(s.a)(_,2),Y=W[0],Z=W[1],K=Object(r.useState)(null),M=Object(s.a)(K,2),Q=M[0],X=M[1],$=Object(m.g)(),ee=Object(r.useContext)(f).getSession;Object(r.useEffect)((function(){ee().then(function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.headers,e.next=3,n;case 3:r=e.sent,B(r),ne(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){console.log(e),console.log("redirecting to login"),$.push("/Login")}))}),[]);var te=function(){var t=Object(l.a)(i.a.mark((function t(n,r){var c,a,s,o,u,j=arguments;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=j.length>2&&void 0!==j[2]&&j[2],a=j.length>3&&void 0!==j[3]?j[3]:"",s=j.length>4&&void 0!==j[4]?j[4]:z,o=b.ApiURL,t.t0=r,t.next="post"===t.t0?7:9;break;case 7:return u=new Request(o+n,{method:r,headers:s,body:a}),t.abrupt("break",10);case 9:u=new Request(o+n,{method:r,headers:s});case 10:return t.next=12,fetch(u).then((function(e){if(!e.ok)throw new Error(e.statusText);return e})).then((function(e){return A(!1),c?e.json():e.text()})).catch((function(t){console.log(t),e.setError({message:"The API call returned an Error."}),"Unauthorized"==t&&$.push("/Login"),H(!1),X(null),Z(!1),y(!1),C(null),A(!1)}));case 12:return t.abrupt("return",t.sent);case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ne=function(){var e=Object(l.a)(i.a.mark((function e(){var t,n,r=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:z,e.next=3,te("","get",!0,"",t);case 3:n=e.sent,a(n),d({NoteId:""}),v(!0),y(!1),C(null);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re={handleSelectNote:function(e){j.NoteId===e||void 0===e?d({NoteId:""}):d(c.find((function(t){return t.NoteId===e})))},updateNote:function(){var e=Object(l.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),r={NoteId:parseInt(t.NoteId),Note:n},e.next=4,te("","post",!1,JSON.stringify(r));case 4:ne();case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),addNote:function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),n=[],c.map((function(e){return n.push(parseInt(e.NoteId))})),n=n.sort((function(e,t){return t-e})),r=n.length>0?n[0]+1:1,a={NoteId:r,Note:t},e.next=8,te("","post",!1,JSON.stringify(a));case 8:ne();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),speakNote:function(){var e=Object(l.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(!0),X(null),e.t0=X,e.next=5,te("/"+t,"post",!0,JSON.stringify({VoiceId:n}));case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteNote:function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(t),e.next=3,te("/"+t,"delete");case 3:ne();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),filterNotes:function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("filter with API:"+t),A(!0),e.t0=a,e.next=5,te("/search?text="+t,"get",!0);case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};return Object(x.jsxs)("div",{children:[Object(x.jsx)(E,{show:V,setShow:H,loading:Y,url:Q}),p?Object(x.jsx)(J,{searching:U,deleting:k,notes:c,noteFunctions:re,selNote:j}):Object(x.jsx)(T,{}),Object(x.jsx)(G,{updating:N,selNote:j,noteFunctions:re})]})},D=function(e){var t=Object(r.useState)(""),n=Object(s.a)(t,2),c=n[0],a=n[1],o=Object(r.useState)(""),i=Object(s.a)(o,2),u=i[0],j=i[1],l=Object(r.useState)(!1),d=Object(s.a)(l,2),b=d[0],h=d[1],O=Object(m.g)(),p=Object(r.useContext)(f),v=p.authenticate,w=p.LoggedIn;return Object(x.jsx)(g.a,{children:w?Object(x.jsx)(m.a,{to:"/"}):Object(x.jsxs)(F.a,{onSubmit:function(e){e.preventDefault(),h(!0),v(c,u).then((function(e){O.push("/")})).catch((function(e){h(!1)}))},children:[Object(x.jsxs)(F.a.Group,{controlId:"username",children:[Object(x.jsx)(F.a.Label,{srOnly:!0,children:"Username:"}),Object(x.jsxs)(L.a,{children:[Object(x.jsx)(L.a.Prepend,{children:Object(x.jsx)(L.a.Text,{children:"Username:"})}),Object(x.jsx)(F.a.Control,{value:c,onChange:function(e){return a(e.target.value)}})]})]}),Object(x.jsxs)(F.a.Group,{controlId:"password",children:[Object(x.jsx)(F.a.Label,{srOnly:!0,children:"Password:"}),Object(x.jsxs)(L.a,{children:[Object(x.jsx)(L.a.Prepend,{children:Object(x.jsx)(L.a.Text,{children:"Password:"})}),Object(x.jsx)(F.a.Control,{type:"password",value:u,onChange:function(e){return j(e.target.value)}})]})]}),Object(x.jsx)(y.a,{variant:"primary",type:"submit",children:b?Object(x.jsx)(T,{}):"Login"})]})})},q=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),o=Object(s.a)(a,2),i=o[0],u=o[1];return Object(x.jsx)(g.a,{children:Object(x.jsxs)(F.a,{onSubmit:function(e){e.preventDefault(),O.signUp(n,i,[],null,(function(e,t){e&&console.error(e),console.log(t)}))},children:[Object(x.jsxs)(F.a.Group,{controlId:"username",children:[Object(x.jsx)(F.a.Label,{srOnly:!0,children:"Username:"}),Object(x.jsxs)(L.a,{children:[Object(x.jsx)(L.a.Prepend,{children:Object(x.jsx)(L.a.Text,{children:"Username:"})}),Object(x.jsx)(F.a.Control,{value:n,onChange:function(e){return c(e.target.value)}})]})]}),Object(x.jsxs)(F.a.Group,{controlId:"password",children:[Object(x.jsx)(F.a.Label,{srOnly:!0,children:"Password:"}),Object(x.jsxs)(L.a,{children:[Object(x.jsx)(L.a.Prepend,{children:Object(x.jsx)(L.a.Text,{children:"Password:"})}),Object(x.jsx)(F.a.Control,{type:"password",value:i,onChange:function(e){return u(e.target.value)}})]})]}),Object(x.jsx)(y.a,{variant:"primary",type:"submit",children:"Signup"})]})})},V=n(61),H=n(62),_=n(64),W=n(63),Y=function(e){Object(_.a)(n,e);var t=Object(W.a)(n);function n(){var e;Object(V.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={error:"",errorInfo:"",hasError:!1},e}return Object(H.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log({error:e,errorInfo:t}),this.setState({errorInfo:t})}},{key:"render",value:function(){var e=this.state,t=e.hasError;e.errorInfo;return t?Object(x.jsx)("div",{className:"card my-5",children:Object(x.jsx)("div",{className:"card-header",children:Object(x.jsxs)("p",{children:["There was an error in loading this page. Check the API URL or errors in the logs of your list-function."," ",Object(x.jsx)("span",{style:{cursor:"pointer",color:"#0077FF"},onClick:function(){window.location.reload()},children:"Reload this page"})," "]})})}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}]),n}(r.Component);var Z=function(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){var e=setTimeout((function(){return c(null)}),5e3);return function(){try{clearTimeout(e)}catch(t){}}}),[n]),Object(x.jsx)(p,{setError:c,children:Object(x.jsxs)(v.a,{children:[Object(x.jsx)(I,{}),n?Object(x.jsx)(k,{error:n}):null,Object(x.jsx)(g.a,{className:"main_app",children:Object(x.jsxs)(m.d,{children:[Object(x.jsx)(m.b,{path:"/Login",children:Object(x.jsx)(D,{})}),Object(x.jsx)(m.b,{path:"/Signup",children:Object(x.jsx)(q,{})}),Object(x.jsx)(m.b,{path:"/",children:Object(x.jsx)(Y,{children:Object(x.jsx)(B,{setError:c})})})]})})]})})};n(82);a.a.render(Object(x.jsx)(Z,{}),document.getElementById("root"))}},[[83,1,2]]]);
//# sourceMappingURL=main.daf464ec.chunk.js.map